# -*- coding: utf-8 -*-
"""Negative.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1wxORz5IOEYjwrsoxBjQ8Cg_SKFhLMi7O
"""

pip install transformers

import torch
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM

model_name = 'minwhoo/bart-base-negative-claim-generation'
tokenizer = AutoTokenizer.from_pretrained(model_name)

model = AutoModelForSeq2SeqLM.from_pretrained(model_name)
model.to('cuda' if torch.cuda.is_available() else 'cpu')



import pandas as pd
df=pd.read_csv('/content/USE.csv',encoding='utf-8')

df

examples1=df['Sentences'].tolist()

examples=examples1[:100]

negative_examples1=[]
for i in range(0,len(examples1),100):
    examples = examples1[i:i+100]
    print(i)
    batch = tokenizer(examples, max_length=4096, padding=True, truncation=True, return_tensors="pt")
    out = model.generate(batch['input_ids'].to(model.device), num_beams=5)
    negative_examples = tokenizer.batch_decode(out, skip_special_tokens=True)
    negative_examples1=negative_examples1 +negative_examples

df1 = pd.DataFrame(negative_examples1)



df1.to_csv("NegativeUSE.csv")

